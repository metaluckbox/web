{"version":3,"file":"pages/history/index.js","sources":["webpack:///./pages/history/index.vue?8484","webpack:///./pages/history/index.vue","webpack:///./pages/history/index.vue?15c0","webpack:///./pages/history/index.vue?bb62","webpack:///./components/Popup/Metamask.vue?33d2","webpack:///./assets/ico/metamask-fox.svg","webpack:///./components/Head.vue?b8e7","webpack:///./assets/logo/logo.png","webpack:///./components/Head.vue?470a","webpack:///./components/Head.vue","webpack:///./components/Head.vue?570a","webpack:///./components/Head.vue?9a6c","webpack:///./assets/ico/clone.png","webpack:///./components/Popup/Metamask.vue?c469","webpack:///./components/Popup/Metamask.vue?5597","webpack:///./components/Popup/Metamask.vue?597e","webpack:///./components/Popup/Metamask.vue","webpack:///./components/Popup/Metamask.vue?ec07","webpack:///./components/Popup/Metamask.vue?045d","webpack:///./components/Head.vue?56ff","webpack:///./components/Head.vue?ff3b","webpack:///./assets/ico/singin.png","webpack:///./utils/axios.js","webpack:///./common/minxins/mint.js","webpack:///./pages/history/index.vue?994c","webpack:///./assets/history/tables.png","webpack:///./assets/ico/usd.png","webpack:///./pages/history/index.vue?84b3","webpack:///./pages/history/index.vue?314d","webpack:///./assets/history/back.png"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('Head'),_vm._ssrNode(\" \"),_vm._ssrNode(\"<div class=\\\"history\\\" data-v-af2137a0>\",\"</div>\",[(_vm.loading)?_vm._ssrNode(\"<ul data-v-af2137a0>\",\"</ul>\",[_vm._ssrNode(\"<li class=\\\"title\\\" data-v-af2137a0><strong data-v-af2137a0> # </strong> <strong class=\\\"nftId\\\" data-v-af2137a0> NFT ID </strong> <strong data-v-af2137a0> Start Time </strong> <strong data-v-af2137a0> End Time </strong> <strong data-v-af2137a0> Prize </strong></li> <img width=\\\"100%\\\"\"+(_vm._ssrAttr(\"src\",require(\"assets/history/tables.png\")))+\" style=\\\"margin-bottom: 20px\\\" data-v-af2137a0> \"+(_vm._ssrList((_vm.eventAttr),function(item,key){return (\"<li class=\\\"tableBody\\\" data-v-af2137a0><p data-v-af2137a0><span class=\\\"index\\\" data-v-af2137a0>\"+_vm._ssrEscape(\" \"+_vm._s(key + 1)+\" \")+\"</span></p> <p class=\\\"back\\\" data-v-af2137a0>\"+_vm._ssrEscape(_vm._s(item.winnerId))+\"</p> <p class=\\\"item\\\" data-v-af2137a0><span data-v-af2137a0>\"+_vm._ssrEscape(_vm._s(_vm.moment(item.startTimestamp * 1000).format(\"HH:mm:ss\")))+\"</span> <label data-v-af2137a0>\"+_vm._ssrEscape(_vm._s(_vm.moment(item.startTimestamp * 1000).format(\"YYYY-MM-DD\")))+\"</label></p> <p class=\\\"item\\\" data-v-af2137a0><span data-v-af2137a0>\"+_vm._ssrEscape(_vm._s(_vm.moment(item.closeTimestamp * 1000).format(\"HH:mm:ss\")))+\"</span> <label data-v-af2137a0>\"+_vm._ssrEscape(_vm._s(_vm.moment(item.closeTimestamp * 1000).format(\"YYYY-MM-DD\")))+\"</label></p> <p class=\\\"usd\\\" data-v-af2137a0><img\"+(_vm._ssrAttr(\"src\",require(\"assets/ico/usd.png\")))+\" data-v-af2137a0> <span data-v-af2137a0>\"+_vm._ssrEscape(_vm._s(item.jackpotAmount / _vm.singNum)+\" ETH\")+\"</span></p></li>\")})))],2):_vm._ssrNode(\"<div style=\\\"text-align: center; padding: 30px 0px\\\" data-v-af2137a0>\",\"</div>\",[_c('a-spin',{attrs:{\"size\":\"large\"}})],1)])],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Web3 from \"web3\";\nimport minxins from \"@/common/minxins/mint.js\";\nimport moment from \"moment\";\nexport default {\n  name: \"IndexPage\",\n  mixins: [minxins],\n  data() {\n    return {\n      eventAttr: [],\n      moment,\n      loading: false,\n    };\n  },\n  async mounted() {\n    const web3 = new Web3(\n      new Web3.providers.HttpProvider(\n        \"https://goerli.infura.io/v3/41d3db874b584770865cb0c194f39c47\"\n      )\n    );\n    const events = await web3.eth.getPastLogs({\n      address: \"0xe37971960574A60ec0078c0b370a62595AB288FA\",\n      topics: [\n        \"0xf8661aec877e4b8b87afea92dee5fda3b952cb324def1d37b09f00475473cbdc\",\n      ],\n      fromBlock: 0,\n    });\n\n    const roundAttr = [];\n    for (let i = 0; i < events.length; i++) {\n      let event = events[i];\n      // console.log(JSON.stringify(event));\n      // 获取到账户\n      // 获取到当前轮数据\n      let round = parseInt(event.topics[1]);\n      let callRound = [\n        this.contractAddr,\n        await this.contract.methods.rounds(round).encodeABI(),\n      ];\n      roundAttr.push(callRound);\n    }\n    const roundResult = await this.multicall.methods\n      .aggregate(roundAttr)\n      .call();\n    const eventAttr = [];\n    for (let item in roundResult[\"1\"]) {\n      const ids = roundResult[\"1\"][item];\n      const startTimestamp = parseInt(\"0x\" + ids.substring(66, 130));\n      const closeTimestamp = parseInt(\"0x\" + ids.substring(194, 258));\n      const winnerId = parseInt(\n        \"0x\" + ids.substring(66 + 64 * 9, 66 + 64 * 10)\n      );\n      const jackpotAmount = parseInt(\n        \"0x\" + ids.substring(66 + 64 * 6, 66 + 64 * 7)\n      );\n      eventAttr.push({\n        startTimestamp,\n        closeTimestamp,\n        winnerId,\n        jackpotAmount,\n        transactionHash:\n          \"https://rinkeby.etherscan.io/tx/\" + events[item][\"transactionHash\"],\n      });\n    }\n    this.eventAttr = eventAttr;\n    this.loading = true;\n  },\n  methods: {\n    async handleEvent(event) {\n      let round = parseInt(event.topics[1]);\n      let tokenId = parseInt(event.topics[2]);\n\n      let blockNumber = parseInt(event.blockNumber);\n      let address = \"\";\n      let rounds = \"\";\n      try {\n        address = await this.contract.methods.ownerOf(tokenId).call();\n        rounds = await this.contract.methods.rounds(round).call();\n      } catch (e) {}\n      return {\n        round,\n        tokenId,\n        address,\n        blockNumber,\n        rounds,\n      };\n    },\n  },\n};\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=af2137a0&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  var style0 = require(\"./index.vue?vue&type=style&index=0&id=af2137a0&scoped=true&lang=less&\")\nif (style0.__inject__) style0.__inject__(context)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"af2137a0\",\n  \"245717c3\"\n  \n)\n\nexport default component.exports\n\n/* nuxt-component-imports */\ninstallComponents(component, {Head: require('/Users/talk/Desktop/document/RioDefi/rio/lottery/components/Head.vue').default})\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-1-3!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Metamask.vue?vue&type=style&index=0&id=cae1559e&scoped=true&lang=less&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add CSS to SSR context\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesServer.js\").default\nmodule.exports.__inject__ = function (context) {\n  add(\"e32ad1f6\", content, true, context)\n};","module.exports = __webpack_public_path__ + \"img/metamask-fox.7db9467.svg\";","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-2!../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-1-3!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Head.vue?vue&type=style&index=0&id=04e97453&scoped=true&lang=less&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add CSS to SSR context\nvar add = require(\"!../node_modules/vue-style-loader/lib/addStylesServer.js\").default\nmodule.exports.__inject__ = function (context) {\n  add(\"5183b5b5\", content, true, context)\n};","module.exports = __webpack_public_path__ + \"img/logo.eb8b110.png\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"header\"},[_vm._ssrNode(\"<header data-v-04e97453>\",\"</header>\",[_vm._ssrNode(\"<ul class=\\\"container\\\" data-v-04e97453>\",\"</ul>\",[_vm._ssrNode(\"<li data-v-04e97453>\",\"</li>\",[_c('nuxt-link',{attrs:{\"to\":\"/\"}},[_c('img',{attrs:{\"src\":require(\"assets/logo/logo.png\")}})])],1),_vm._ssrNode(\" \"),_vm._ssrNode(\"<li data-v-04e97453>\",\"</li>\",[_c('nuxt-link',{attrs:{\"to\":\"/home\"}},[_vm._v(\" Mint \")]),_vm._ssrNode(\" \"),_c('nuxt-link',{attrs:{\"to\":\"/claim\"}},[_vm._v(\" Claim \")]),_vm._ssrNode(\" \"),_c('nuxt-link',{attrs:{\"to\":\"/nft\"}},[_vm._v(\" Collection \")]),_vm._ssrNode(\" \"),_c('nuxt-link',{attrs:{\"to\":\"/history\"}},[_vm._v(\" History \")]),_vm._ssrNode(\" \"+((_vm.$route.path == '/')?(\"<a href=\\\"#faq\\\" data-v-04e97453> FAQ </a>\"):\"<!---->\")+\" <p data-v-04e97453><img\"+(_vm._ssrAttr(\"src\",require(\"assets/ico/metamask-fox.svg\")))+\" data-v-04e97453> \"+((_vm.accounts[0])?(\"<a data-v-04e97453>\"+_vm._ssrEscape(_vm._s(_vm._f(\"userInformation\")(_vm.accounts[0])))+\"</a>\"):(\"<a data-v-04e97453> Connect Wallet </a>\"))+\"</p>\")],2)],2)]),_vm._ssrNode(\" \"),_c('Metamask')],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Web3 from \"web3\";\nimport Metamask from \"@/components/Popup/Metamask.vue\";\n// import minxins from \"@/common/minxins/mint.js\";\nexport default {\n  name: \"Head\",\n  components: { Metamask },\n  // mixins: [minxins],\n  data() {\n    return {\n      accounts: [],\n      web3: \"\",\n    };\n  },\n  async mounted() {\n    this.web3 = new Web3(window.ethereum);\n    this.accounts = await this.web3.eth.getAccounts();\n  },\n  // async mounted() {\n  //   this.web3 = new Web3(window.ethereum);\n  //   this.accounts = await this.web3.eth.getAccounts();\n  //   // this.accounts = await ethereum.enable();\n  //   ethereum.enable().then((accounts) => {\n  //     this.accounts = accounts;\n  //   });\n\n  //   ethereum.on(\"accountsChanged\", (accounts) => {\n  //     this.accounts = accounts;\n  //   });\n  //   ethereum.on(\"networkChanged\", (networkIDstring) => {\n  //     if (networkIDstring !== 4) {\n  //       this.switchEthereumChain(4);\n  //     }\n  //   });\n  //   if (ethereum.networkVersion !== 4) {\n  //     this.switchEthereumChain(4);\n  //   }\n  // },\n  methods: {\n    async singInEve() {\n      const getAccounts = await this.web3.eth.getAccounts();\n      this.accounts = await window.ethereum.enable();\n      if (getAccounts.length === 0) {\n        location.reload();\n      }\n    },\n    singUpEve() {\n      window.ethereum.request({\n        method: \"wallet_addEthereumChain\",\n        params: [\n          {\n            chainId: Web3.utils.numberToHex(56), // 目标链ID\n            chainName: \"Binance Smart Chain Mainnet\",\n            nativeCurrency: {\n              name: \"bnb\",\n              symbol: \"bnb\",\n              decimals: 18,\n            },\n            rpcUrls: [\"https://bsc-dataseed.binance.org\"], // 节点\n            blockExplorerUrls: [\"https://www.bscscan.com\"],\n          },\n        ],\n      });\n    },\n    switchEthereumChain(value) {\n      window.ethereum.request({\n        method: \"wallet_switchEthereumChain\",\n        params: [\n          {\n            chainId: Web3.utils.numberToHex(value), // 目标链ID\n          },\n        ],\n      });\n    },\n  },\n};\n","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Head.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Head.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Head.vue?vue&type=template&id=04e97453&scoped=true&\"\nimport script from \"./Head.vue?vue&type=script&lang=js&\"\nexport * from \"./Head.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  var style0 = require(\"./Head.vue?vue&type=style&index=0&id=04e97453&scoped=true&lang=less&\")\nif (style0.__inject__) style0.__inject__(context)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"04e97453\",\n  \"ebad04e0\"\n  \n)\n\nexport default component.exports","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAfCAYAAADwbH0HAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAIDSURBVHgBvZcLccMwDEAdBmYwM1ggBMIYLAwWBs0QrEOQQigDh0FbBCmDlYEmrXJP8fztetOdmka29Cw7SuxGVQgAaLx0qAZVs/mCeiRtmuaiHiUEQ92gWsjLAbVHNbm4TQqIlzfUQa2zO6GeWRW3tajPoh+17XAG3lVllgZ1EZnMqB0PJuX3wn2dLCXZO+cW9Us4dqpSeJBu4BSrrYHuchlmYmmOkYZ707tVDxKKlZx2MbrZs9+dtYhhObb1G7rQqLg0SDaFDPLZsM8gbEYsYRca0egFceAiuICS9F7buMqaR+MeABMINpbAPegYaNcia0OGgW+mRNAkPAcV/Xa3ZcCfPd+8qITE4KVQ7uuWbk83B75JF3kAXgNlf7esi3JeqlA8eDGUffWNVwvmAFZAbaXvGgyFLwpvem/TrgpFgs/83xQ4SegIhaUm/Fvue5BPdV8DFfZiOFw/myT70joOQmvh4NWxfHPpWmgpHNbva+OMNhQY1u/qKDQC7yMJzNLYiayNsA+l0AC8V+tsF7Z3voPlhqq6jMB1JPYU6ixH9aEeJBSLYy4QK1lY77km+PueaxJLWLXhW+A/dpnCUU77z7pD/rOpGWiFX3R6m0ywES+v6npWInHnpBP/J3nidspKnjg+Ubd3n6c4e6rnI+Rlhms5ZZ+NRlUIB2zV7+zOqHNNdt+QN9JhdBzc3gAAAABJRU5ErkJggg==\"","export * from \"-!../../node_modules/vue-style-loader/index.js??ref--5-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-1-3!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Metamask.vue?vue&type=style&index=0&id=cae1559e&scoped=true&lang=less&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(false);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".popupMetamask .popup[data-v-cae1559e]{width:100%;height:100%;background-color:rgba(0,0,0,.8);z-index:11;top:50%}.popupMetamask .contentBox[data-v-cae1559e],.popupMetamask .popup[data-v-cae1559e]{color:#fff;position:fixed;left:50%;transform:translate(-50%,-50%)}.popupMetamask .contentBox[data-v-cae1559e]{top:30%;z-index:12;text-align:center}.popupMetamask .contentBox .content[data-v-cae1559e]{background:linear-gradient(108.4deg,#adafae 37.46%,#aeddcf 87.92%,#afffe8 157.07%),linear-gradient(107.35deg,rgba(199,255,252,.2) 38.1%,rgba(176,255,250,0) 132.78%);width:314px;height:197px}.popupMetamask .contentBox .content h3[data-v-cae1559e]{color:#fff;font-size:24px;font-weight:700;text-align:center;padding-top:22px}.popupMetamask .contentBox .content p label[data-v-cae1559e]{font-size:14px;display:block;margin-top:14px}.popupMetamask .contentBox .clone[data-v-cae1559e]{margin-top:18px}.popupMetamask .contentBox img[data-v-cae1559e]{cursor:pointer}\", \"\"]);\n// Exports\nmodule.exports = ___CSS_LOADER_EXPORT___;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.bollPopup)?_c('div',{staticClass:\"popupMetamask\"},[_vm._ssrNode(\"<p class=\\\"popup\\\" data-v-cae1559e></p> <div class=\\\"contentBox\\\" data-v-cae1559e><div class=\\\"content\\\" data-v-cae1559e><h3 data-v-cae1559e>Connect your wallet</h3> <p data-v-cae1559e><img width=\\\"76px\\\"\"+(_vm._ssrAttr(\"src\",require(\"assets/ico/metamask-fox.svg\")))+\" data-v-cae1559e> <label data-v-cae1559e> MetaMask </label></p></div> <img\"+(_vm._ssrAttr(\"src\",require(\"assets/ico/clone.png\")))+\" class=\\\"clone\\\" data-v-cae1559e></div>\")]):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n  name: \"popupMetamask\",\n  data() {\n    return {\n      bollPopup: false,\n    };\n  },\n};\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Metamask.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Metamask.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Metamask.vue?vue&type=template&id=cae1559e&scoped=true&\"\nimport script from \"./Metamask.vue?vue&type=script&lang=js&\"\nexport * from \"./Metamask.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  var style0 = require(\"./Metamask.vue?vue&type=style&index=0&id=cae1559e&scoped=true&lang=less&\")\nif (style0.__inject__) style0.__inject__(context)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"cae1559e\",\n  \"61c4a044\"\n  \n)\n\nexport default component.exports","export * from \"-!../node_modules/vue-style-loader/index.js??ref--5-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-2!../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-1-3!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Head.vue?vue&type=style&index=0&id=04e97453&scoped=true&lang=less&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/css-loader/dist/runtime/api.js\");\nvar ___CSS_LOADER_GET_URL_IMPORT___ = require(\"../node_modules/css-loader/dist/runtime/getUrl.js\");\nvar ___CSS_LOADER_URL_IMPORT_0___ = require(\"../assets/ico/singin.png\");\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(false);\nvar ___CSS_LOADER_URL_REPLACEMENT_0___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_0___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".header[data-v-04e97453]{background-color:#242424}.header ul[data-v-04e97453]{margin:auto;height:80px;line-height:80px;border-bottom:1px solid #383838}.header ul[data-v-04e97453],.header ul li[data-v-04e97453]{display:flex;justify-content:space-between;align-items:center}.header ul li a[data-v-04e97453]{color:#fff;font-size:16px;margin-right:32px}.header ul li p[data-v-04e97453]{display:inline-block;background:url(\" + ___CSS_LOADER_URL_REPLACEMENT_0___ + \") no-repeat;background-size:100% 100%;height:47px;line-height:47px;padding:0 30px;width:230px;overflow:hidden;text-align:center}.header ul li p img[data-v-04e97453]{margin-right:20px;width:27px}.header ul li p a[data-v-04e97453]{margin:0}\", \"\"]);\n// Exports\nmodule.exports = ___CSS_LOADER_EXPORT___;\n","module.exports = __webpack_public_path__ + \"img/singin.aa106f2.png\";","//1、引入axios\nimport axios from 'axios'\nimport { Router } from 'vue-router'\nimport { Button, message } from 'ant-design-vue'\n//2、创建axios的实例\nlet httpService = axios.create({\n  baseUrl: process.env.NODE_ENV === 'development' ? '/devApi' : '/proApi', // TODO:具体的配置可以根据项目情况而来\n  timeout: 60000,\n})\n//5、get请求的封装\nexport function get(url, params = {}, headers = {}) {\n  return new Promise((resolve, reject) => {\n    httpService({\n      url: url,\n      method: 'get',\n      params: params,\n      headers: headers,\n    })\n      .then((res) => {\n        resolve(res.data)\n      })\n      .catch((err) => {\n        reject(err)\n      })\n  })\n}\n\nexport function post(\n  url,\n  params = {},\n  headers = { 'Content-Type': 'application/json' }\n) {\n  return new Promise((resolve, reject) => {\n    if (!params.game_id) {\n      params['game_id'] = parseInt(localStorage.getItem('gameid'))\n    }\n    params['access_token'] = localStorage.getItem('access_token')\n    httpService({\n      url: url,\n      method: 'post',\n      data: params,\n      headers: headers,\n    })\n      .then((res) => {\n        if (res.data.code == 1001) {\n          localStorage.removeItem('access_token')\n          window.location.replace(\"/\")\n        }\n        if (res.data.code) {\n          message.warning(res.data.message)\n        }\n        resolve(res.data || {})\n      })\n      .catch((err) => {\n        reject(err)\n      })\n  })\n}\n//7、将模块暴露\nexport default {\n  get,\n  post,\n}\n","import Web3 from \"web3\";\nimport moment from \"moment\";\nimport ABI from '@/common/json/abi.json'\nimport multicallABI from '@/common/json/multicall.json'\nimport { notification, message } from 'ant-design-vue';\nimport { get, post } from \"~/utils/axios.js\";\nexport default {\n  data() {\n    return {\n      accounts: [],\n      contract: \"\",\n      web3: \"\",\n      result: { mainThisNum: 0, jackpotAmount: 0 },\n      amount: null,\n      claimId: \"\",\n      currentEpoch: \"\",\n      itemDate: { \"h\": \"00\", \"m\": \"00\", \"s\": \"00\" },\n      nftIdAttr: [],\n      claimNftIdAttr: [],\n      mintLimitPerRound: 0,\n      mintPrice: 0,\n      jackpotAmount: 0,\n      balanceNum: 1,\n      claimNftBoll: true,\n      mintNum: 1,\n      contractAddr: \"0xe37971960574A60ec0078c0b370a62595AB288FA\",\n      singNum: 1000000000000000000\n    }\n  },\n\n  async mounted() {\n    this.web3 = new Web3(window.ethereum);\n    const getAccounts = await this.web3.eth.getAccounts();\n    this.accounts = await window.ethereum.enable();\n    if (getAccounts.length === 0) {\n      location.reload();\n    }\n    //监听账号切换\n    ethereum.on('accountsChanged', function (accounts) {\n      location.reload();\n    })\n    ethereum.on(\"networkChanged\", (networkIDstring) => {\n      console.log(networkIDstring)\n      if (networkIDstring !== '5') {\n        this.switchEthereumChain(5);\n      }\n      location.reload();\n    });\n    console.log(ethereum.networkVersion)\n    if (ethereum.networkVersion !== '5') {\n      this.switchEthereumChain(5);\n      notification.error({\n        message: 'MetaMask',\n        description: 'Network error, please switch'\n      })\n      return\n    }\n\n    this.contract = new this.web3.eth.Contract(\n      ABI,\n      this.contractAddr\n    );\n    this.multicall = new this.web3.eth.Contract(\n      multicallABI,\n      \"0x42ad527de7d4e9d9d011ac45b31d8551f8fe9821\"\n    );\n    this.init();\n  },\n  methods: {\n    async estimateGas(func, value = 0) {\n      try {\n        const gas = await func.estimateGas({\n          from: this.accounts[0],\n          value,\n        });\n        return Math.floor(gas * 1.2);\n      } catch (error) {\n        console.log(\"errr\", error.message);\n        const objStartIndex = error.message.indexOf(\"{\");\n        notification.error({\n          message: 'MetaMask',\n          description: error.message.slice(0, objStartIndex)\n        })\n      }\n    },\n    switchEthereumChain(value) {\n      window.ethereum.request({\n        method: \"wallet_switchEthereumChain\",\n        params: [\n          {\n            chainId: Web3.utils.numberToHex(value), // 目标链ID\n          },\n        ],\n      });\n    },\n    async init() {\n      this.nftIdAttr = []\n      this.claimNftIdAttr = []\n      this.contract.methods.mintLimitPerRound().call().then((value) => {\n        this.mintLimitPerRound = value\n      })\n      this.contract.methods.mintPrice().call().then((value) => {\n        this.mintPrice = value\n      })\n\n      const LastCurrentEpoch = await this.contract.methods.currentEpoch().call();\n      if (LastCurrentEpoch > 1) {\n        const { jackpotAmount } = await this.contract.methods.rounds(LastCurrentEpoch - 1).call();\n        this.jackpotAmount = jackpotAmount\n      }\n\n      const balanceNum = await this.contract.methods\n        .balanceOf(this.accounts[0])\n        .call();\n      this.balanceNum = parseInt(balanceNum);\n      console.log(balanceNum)\n      if (!this.balanceNum) {\n        this.claimNftBoll = false\n      }\n\n      const calls = []\n      for (let i = 0; i < this.balanceNum; i++) {\n        let call = [\n          this.contractAddr,\n          await this.contract.methods.tokenOfOwnerByIndex(this.accounts[0], i).encodeABI()\n        ]\n        calls.push(call)\n      }\n      const tokenIdsResult = await this.multicall.methods.aggregate(calls).call();\n      let tokenIds = tokenIdsResult[1]\n      const winnerNFT = await this.multicallEve(tokenIds, 'winnerNFT')\n      const winnerClaimed = await this.multicallEve(tokenIds, 'winnerClaimed')\n      const tokenURI = await this.multicallEve(tokenIds, 'tokenURI')\n\n\n      for (let i = 0; i < tokenIds.length; i++) {\n        const isWin = this.web3.utils.hexToBytes('0x' + winnerNFT[1][i].substring(2, 66))[31]\n        const epoch = this.web3.utils.hexToBytes('0x' + winnerNFT[1][i].substring(66, 130))[31]\n        const isBool = this.web3.utils.hexToBytes('0x' + winnerClaimed[1][i].substring(2, 66))[31]\n        const hexToAsciis = this.web3.utils.hexToAscii(tokenURI[1][i])\n        const { image } = await get(hexToAsciis.substring(64, hexToAsciis.length))\n\n        const { refundPrice, jackpotAmount } = await this.contract.methods.rounds(epoch).call();\n        this.nftIdAttr.push({\n          id: parseInt(tokenIds[i]),\n          boll: false,\n          isWin: isWin,\n          image: image,\n          refundPrice: refundPrice / this.singNum\n        })\n        if (isWin && (!isBool)) {\n          // const { jackpotAmount } = await this.contract.methods.rounds(epoch).call();\n          this.claimNftIdAttr.push({\n            id: parseInt(tokenIds[i]),\n            boll: false,\n            image: image,\n            jackpotAmount: jackpotAmount / this.singNum\n          })\n        }\n      }\n      if (!this.claimNftIdAttr.length) {\n        this.claimNftBoll = false\n      }\n    },\n    async multicallEve(tokenIds, type) {\n      let winners = []\n      for (let i = 0; i < tokenIds.length; i++) {\n        let tokenId = parseInt(tokenIds[i])\n        let winner = [\n          this.contractAddr,\n          await this.contract.methods[type](tokenId).encodeABI()\n        ]\n        winners.push(winner)\n      }\n      let winnerResult = await this.multicall.methods.aggregate(winners).call();\n      return winnerResult\n    }\n  },\n}","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-1-3!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=af2137a0&scoped=true&lang=less&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add CSS to SSR context\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesServer.js\").default\nmodule.exports.__inject__ = function (context) {\n  add(\"59303258\", content, true, context)\n};","module.exports = __webpack_public_path__ + \"img/tables.2355b88.png\";","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAATCAYAAACKsM07AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFQSURBVHgBrVSBUcMwDFQ4BsgGeAO6AR6hbMAGdAOyAd0gbEA2aJiAdIKGCZINjERfRicSDtL8nU6NLOtfcu2C/oGUUmRXsnVFUfS0Jrj4Nn3jxFbSmkBRi4rWAhd7MIXf4Yc/d4H2ReFBirm1YNTX+B7w/exyS7Yn5NdZwET7J6gO2KAIyK9sTA6f7cUQK/ZKMJi2PZGidkrn9gwmlgkOWsSo8UTBjWM3UbhCR4qtJu+1kJu9xBu2zczZ7bAuvkQsGoJAs8GF8GKvEO9MTqTLcAt/zAR87UdDsqHLEOGbTAC8wd/RQqTzW6XoPEHuIC1/Z7T7kafyVe/aLLYusXXqgis2YrQWEf6ogUwgzy8X+eCfN2yP+A/LgQXYD3COOFHa03nEOt6GZjb4C7YUMQt3BDKaVyiWblooHKGyR2owfgOTbuXsGp7GPf2GpZdtat8nUHA/+MTzbOEAAAAASUVORK5CYII=\"","export * from \"-!../../node_modules/vue-style-loader/index.js??ref--5-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--5-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--5-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--5-oneOf-1-3!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=af2137a0&scoped=true&lang=less&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nvar ___CSS_LOADER_GET_URL_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/getUrl.js\");\nvar ___CSS_LOADER_URL_IMPORT_0___ = require(\"../../assets/history/back.png\");\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(false);\nvar ___CSS_LOADER_URL_REPLACEMENT_0___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_0___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".history[data-v-af2137a0]{margin:auto;max-width:1200px;padding-top:100px;padding-bottom:100px}.history ul li[data-v-af2137a0]{display:flex;justify-content:space-between;align-items:center;margin-bottom:14px}.history ul p[data-v-af2137a0]{width:290px}.history ul .title strong[data-v-af2137a0]{font-weight:700;font-size:16px;line-height:32px;color:#000;text-shadow:-1px 0 #fff,0 1px #fff,1px 0 #fff,0 -1px #fff;display:inline-block;width:290px}.history ul .title .nftId[data-v-af2137a0]{padding-left:20px}.history ul .tableBody[data-v-af2137a0]{color:#fff;font-size:16px}.history ul .tableBody .back[data-v-af2137a0]{background:url(\" + ___CSS_LOADER_URL_REPLACEMENT_0___ + \") no-repeat;background-size:150px 100%;height:40px;line-height:40px;text-indent:20px}.history ul .tableBody .index[data-v-af2137a0]{border-left:6px solid #0297ff;width:45px;height:44px;text-align:center;line-height:44px;display:inline-block;background:radial-gradient(87.18% 87.18% at 7.03%,at 6.18%,rgba(95,254,255,.2) 0,transparent 100%),linear-gradient(152.02deg,#56545f 16.59%,#0d0c13 102.6%),#d9d9d9;background:radial-gradient(87.18% 87.18% at 7.03% 6.18%,rgba(95,254,255,.2) 0,transparent 100%),linear-gradient(152.02deg,#56545f 16.59%,#0d0c13 102.6%),#d9d9d9}.history ul .tableBody .item[data-v-af2137a0]{font-size:16px}.history ul .tableBody .item span[data-v-af2137a0]{display:block}\", \"\"]);\n// Exports\nmodule.exports = ___CSS_LOADER_EXPORT___;\n","module.exports = __webpack_public_path__ + \"img/back.7f3406b.png\";"],"mappings":";;;;;;;;;;;AAAA;AACA;AACA;;;;;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAAA;AACA;AAKA;AACA;AACA;AAGA;AALA;AAQA;AACA;AAAA;AACA;AAEA;AACA;AACA;AAAA;AACA;AAIA;AACA;AACA;AAAA;AAGA;AACA;AAAA;AACA;AACA;AACA;AACA;AAGA;AAGA;AACA;AACA;AACA;AACA;AACA;AALA;AAQA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AApBA;AA/DA;;AC9DA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACXA;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACXA;;;;;;;;;;;;ACAA;AACA;AACA;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAEA;AAAA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AAAA;AACA;AATA;AAHA;AAgBA;AACA;AAAA;AACA;AACA;AACA;AAEA;AACA;AAFA;AAHA;AAQA;AACA;AApCA;AAlCA;;ACjCA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACvBA;;;;;;;;ACAA;AAAA;AAAA;AAAA;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACNA;AACA;AACA;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AADA;AAGA;AACA;AAPA;;ACrBA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACvBA;AAAA;AAAA;AAAA;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACTA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAFA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAOA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAGA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAJA;AAOA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;;AC3DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlBA;AAoBA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AAIA;AAIA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAAA;AACA;AACA;AACA;AAEA;AACA;AAFA;AAHA;AAQA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAIA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AACA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAIA;AACA;AACA;AAAA;AACA;AACA;AACA;AA7GA;AA9DA;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACXA;;;;;;;ACAA;;;;;;;;ACAA;AAAA;AAAA;AAAA;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACTA;;;;A","sourceRoot":""}